---
title: "BMI_final_project"
author: "Junting Ren Uni:jr3755"
date: "December 9, 2017"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(readxl)
library(janitor)
library(psych)
```

##reading and cleaning the data
```{r reading and cleaning the data}
gh_project <- read_excel("GHProject_Dataset.xlsx", sheet = 1) %>% 
  clean_names() %>% 
  mutate(mews = as.factor(mews), cindex = as.factor(cindex), 
         icu_flag = as.factor(icu_flag), gender = as.factor(gender), race = as.factor(race), religion = as.factor(religion), maritalstatus = as.factor(maritalstatus), insurancetype = as.factor(insurancetype)) %>% 
  arrange(patientid, visitid) %>% 
  filter(!duplicated(patientid))

```

```{r descriptive statistics}
des_stat = gh_project %>%
  select(-gender, -race, -maritalstatus, -facilityname, -insurancetype, -facilityzip, -admitdtm, -religion, -postalcode, -is30dayreadmit, -patientid, -visitid -mews, -cidex, -icu_flag) %>%
  describe(na.rm = TRUE)
  
gender = table(gh_project$gender) %>% prop.table()
race = table(gh_project$race) %>% prop.table()
marital_status = table(gh_project$maritalstatus)  %>% prop.table()
insurance = table(gh_project$insurancetype) %>% prop.table()
religion = table(gh_project$religion) %>% prop.table()
readmit = table(gh_project$is30dayreadmit) %>% prop.table()
mews = table(gh_project$mews) %>% prop.table()
cindex = table(gh_project$cindex) %>% prop.table()
icu_flag = table(gh_project$icu_flag) %>% prop.table()
```

```{r plots}
library(purrr)
library(tidyr)
library(ggplot2)

gh_project %>%
  keep(is.numeric) %>% 
  gather() %>% 
  ggplot(aes(value)) +
    facet_wrap(~ key, scales = "free") +
    geom_histogram()

attach(gh_project)

hist(losdays2)
hist(log(losdays2))

gh_project %>%
  keep(is.numeric) %>% 
  pairs(~ageyear+mews+evisit+cindex+bmi, data=.)

```

```{r transformations}


```

```{r model selection}


```


```{r final model}



```



```{r model validation}


```



```{r check model assumption}



```


###Conclusion